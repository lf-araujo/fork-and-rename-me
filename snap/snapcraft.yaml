name: swift-language
version: '4.0.3'
summary: The Swift Programming Language
description: |
  Swift is a high-performance system programming language. It has a clean and
  modern syntax, offers seamless access to existing C and Objective-C code and
  frameworks, and is memory safe by default.

# TODO:
#  - Build from source http://paste.ubuntu.com/25564789/

confinement: strict
grade: stable
architectures: [ amd64 ]

parts:
  swift:
    plugin: dump
    source: https://swift.org/builds/swift-4.0.3-release/ubuntu1604/swift-4.0.3-RELEASE/swift-4.0.3-RELEASE-ubuntu16.04.tar.gz
    install: |
      if [ "$(arch)" = "x86_64" ]; then
        EXECSTACK_PATH="usr/lib/x86_64-linux-gnu"
      elif [ "$(arch)" = [ "armv7l" ]; then
        EXECSTACK_PATH="usr/lib/arm-linux-gnueabihf"
      else
        echo "unkonwn architecture"
        exit 1
      fi
      execstack -c $SNAPCRAFT_PART_INSTALL/usr/lib/arm-linux-gnueabihf/libBlocksRuntime.so.0.0.0
    build-packages:
      - execstack
    stage-packages:
      - clang
      - libblocksruntime0
      - libbsd0
      - libedit2
      - libicu-dev          # Yes, the -dev package is deliberately staged.
      - libncursesw5
      - libpython2.7
      - libsqlite3-0
      - libuutil1linux
      - libxml2
      - python2.7

apps:
  lldb:
    command: bin/lldb
    aliases: [ lldb ]
  lldb-4-0-0:
    command: bin/lldb-4.0.0
    aliases: [ lldb-4.0.0 ]
  lldb-argdumper:
    command: bin/lldb-argdumper
    aliases: [ lldb-argdumper ]
  lldb-mi:
    command: bin/lldb-mi
    aliases: [ lldb-mi ]
  lldb-mi-4-0-0:
    command: bin/lldb-mi-4.0.0
    aliases: [ lldb-mi-4.0.0 ]
  lldb-server:
    command: bin/lldb-server
    aliases: [ lldb-server ]
  lldb-server-4-0-0:
    command: bin/lldb-server-4.0.0
    aliases: [ lldb-server-4.0.0 ]
  repl-swift:
    command: bin/repl_swift
    aliases: [ repl_swift ]
  swift:
    command: bin/swift
  swift-autolink-extract:
    command: bin/swift-autolink-extract
    aliases: [ swift-autolink-extract ]
  swift-build:
    command: bin/swift-build
    aliases: [ swift-build ]
  swift-build-tool:
    command: bin/swift-build-tool
    aliases: [ swift-build-tool ]
  swift-demangle:
    command: bin/swift-demangle
    aliases: [ swift-demangle ]
  swift-package:
    command: bin/swift-package
    aliases: [ swift-package ]
  swift-test:
    command: bin/swift-test
    aliases: [ swift-test ]
  swiftc:
    command: bin/swiftc
    aliases: [ swiftc ]
